{% extends 'base.html' %}
{% load static %}
{% block content %}
<title>{% block title %}{{websitename}} -| {{blog.title}}{% endblock %}</title>
{% block style %}
<style>
  .banner-area {
       background: url("{{ blog.thumbnail.url }}") no-repeat;
       min-height:400px;
       background-size:cover;
  }
  </style>
  {% endblock %}
    <!--================ Start banner Area =================-->
    <section class="banner-area relative">
        <div class="overlay overlay-bg"></div>
      <div class="banner-content text-center">
        <h1>{{ blog.title }}</h1>
        <p hidden id="analyticsid">{{ blog.blogid }}</p>
      </div>
    </section>
    <!--================ End banner Area =================-->
    <div class="container mt-5">
      <nav aria-label="breadcrumb">
          <ol class="breadcrumb" style="display: flex; flex-wrap: wrap;">
              {% for breadcrumb in breadcrumbs %}
                  <li class="breadcrumb-item">
                      <a href="{{ breadcrumb.url }}"><ion-icon name="cloud-outline"></ion-icon> &nbsp;{{ breadcrumb.title }}</a>
                  </li>
              {% endfor %}
          </ol>
      </nav>
  </div>
        <!--================Blog Area =================-->
        <section class="blog_area section-gap single-post-area">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8">
       					<div class="main_blog_details">
       						<img class="img-fluid" src="{{ blog.thumbnail.url }}" alt="alter order">
       						<a href="#"><h4>{{ blog.title }}</h4></a>
       						<div class="user_details">
       							<div class="float-left">
       								<a href="#">{% for tag in blog.tags.all %}{{tag.name}}{% if not forloop.last %} &nbsp; {% endif %}{% endfor %}</a>
       							</div>
       							<div class="float-right mt-sm-0 mt-3">
       								<div class="media">
       									<div class="media-body">
       										<h5>{{ blog.author.username }}</h5>
       										<p>{{ blog.updated }}</p>
       									</div>
       									<div class="d-flex">
       										<img src="{% static 'img/blog/user-img.jpg' %}" alt="user alter image">
       									</div>
       								</div>
       							</div>
       						</div>
                  <p>{{ blog.content|safe }}</p>
      						
              
              <div class="news_d_footer flex-column flex-sm-row">
      							<!-- <a href="#"><i class="lnr lnr lnr-heart"></i>Lily and 4 people like this</a> -->
      							<!-- <a class="justify-content-sm-center ml-sm-auto mt-sm-0 mt-2" href="#"><i class="lnr lnr lnr-bubble"></i>06 Comments</a> -->
      							<div class="news_socail ml-sm-auto mt-sm-0 mt-2">
									<a href="www.facebook.com "><ion-icon name="logo-facebook"></ion-icon></a>
									<a href="www.twitter.com"><ion-icon name="logo-twitter"></ion-icon></a>
									<a href="youtube.com"><ion-icon name="logo-youtube"></ion-icon></a>
									<a href="pinterest.com"><ion-icon name="logo-pinterest"></ion-icon></a>
									<a href="https://rss.com/blog/how-do-rss-feeds-work/"><ion-icon name="logo-rss"></ion-icon></a>
								</div>
      						</div>
       					</div>
       					<div class="navigation-area">
                            <div class="row">
                                <div class="col-lg-6 col-md-6 col-12 nav-left flex-row d-flex justify-content-start align-items-center">
                                  {% if previous_post %}
                                  <div class="thumb">
                                    <a href="{% url 'detailview' previous_post.category previous_post.slug %}">
                                        <img class="img-fluid" src="{{ previous_post.thumbnail.url }}" alt="previouspost"style="
                                        height: 60px;
                                        width: 70px;
                                    ">
                                    </a>
                                </div>
                                <div class="arrow">
                                    <a href="{% url 'detailview' previous_post.category previous_post.slug %}">
                                        <span class="lnr text-white lnr-arrow-left"></span>
                                    </a>
                                </div>
                                <div class="details">
                                    <p>Prev Post</p>
                                    <a href="{% url 'detailview' previous_post.category previous_post.slug %}">
                                        <h4>{{ previous_post.title }}</h4>
                                    </a>
                                </div>
                                {% endif %}
                                </div>
                                <div class="col-lg-6 col-md-6 col-12 nav-right flex-row d-flex justify-content-end align-items-center"> 
                                  {% if next_post %}
                                  <div class="details">
                                      <p>Next Post</p>
                                      <a href="{% url 'detailview' next_post.category next_post.slug %}" target="_blank"><h4>{{ next_post.title }}</h4></a>
                                  </div>
                                  <div class="arrow">
                                      <a href="{% url 'detailview' next_post.category next_post.slug %}" target="_blank"><span class="lnr text-white lnr-arrow-right"></span></a>
                                  </div>
                                  <div class="thumb">
                                      <a href="{% url 'detailview' next_post.category next_post.slug %}" target="_blank"><img class="img-fluid" src="{{ next_post.thumbnail.url }}" alt="nextpost"style="
                                        height: 60px;
                                        width: 70px;
                                    "></a>
                                  </div>										
                              {% endif %}				
                                </div>									
                            </div>
                        </div>
                       <!-- <div class="comments-area">
                            <h4>05 Comments</h4>
                            <div class="comment-list">
                                <div class="single-comment justify-content-between d-flex">
                                    <div class="user justify-content-between d-flex">
                                        <div class="thumb">
                                            <img src="img/blog/c1.jpg" alt="">
                                        </div>
                                        <div class="desc">
                                            <h5><a href="#">Emilly Blunt</a></h5>
                                            <p class="date">December 4, 2017 at 3:12 pm </p>
                                            <p class="comment">
                                                Never say goodbye till the end comes!
                                            </p>
                                        </div>
                                    </div>
                                    <div class="reply-btn">
                                           <a href="" class="btn-reply text-uppercase">reply</a> 
                                    </div>
                                </div>
                            </div>	
                            <div class="comment-list left-padding">
                                <div class="single-comment justify-content-between d-flex">
                                    <div class="user justify-content-between d-flex">
                                        <div class="thumb">
                                            <img src="img/blog/c2.jpg" alt="">
                                        </div>
                                        <div class="desc">
                                            <h5><a href="#">Elsie Cunningham</a></h5>
                                            <p class="date">December 4, 2017 at 3:12 pm </p>
                                            <p class="comment">
                                                Never say goodbye till the end comes!
                                            </p>
                                        </div>
                                    </div>
                                    <div class="reply-btn">
                                           <a href="" class="btn-reply text-uppercase">reply</a> 
                                    </div>
                                </div>
                            </div>	
                            <div class="comment-list left-padding">
                                <div class="single-comment justify-content-between d-flex">
                                    <div class="user justify-content-between d-flex">
                                        <div class="thumb">
                                            <img src="img/blog/c3.jpg" alt="">
                                        </div>
                                        <div class="desc">
                                            <h5><a href="#">Annie Stephens</a></h5>
                                            <p class="date">December 4, 2017 at 3:12 pm </p>
                                            <p class="comment">
                                                Never say goodbye till the end comes!
                                            </p>
                                        </div>
                                    </div>
                                    <div class="reply-btn">
                                           <a href="" class="btn-reply text-uppercase">reply</a> 
                                    </div>
                                </div>
                            </div>	
                            <div class="comment-list">
                                <div class="single-comment justify-content-between d-flex">
                                    <div class="user justify-content-between d-flex">
                                        <div class="thumb">
                                            <img src="img/blog/c4.jpg" alt="">
                                        </div>
                                        <div class="desc">
                                            <h5><a href="#">Maria Luna</a></h5>
                                            <p class="date">December 4, 2017 at 3:12 pm </p>
                                            <p class="comment">
                                                Never say goodbye till the end comes!
                                            </p>
                                        </div>
                                    </div>
                                    <div class="reply-btn">
                                           <a href="" class="btn-reply text-uppercase">reply</a> 
                                    </div>
                                </div>
                            </div>	
                            <div class="comment-list">
                                <div class="single-comment justify-content-between d-flex">
                                    <div class="user justify-content-between d-flex">
                                        <div class="thumb">
                                            <img src="img/blog/c5.jpg" alt="">
                                        </div>
                                        <div class="desc">
                                            <h5><a href="#">Ina Hayes</a></h5>
                                            <p class="date">December 4, 2017 at 3:12 pm </p>
                                            <p class="comment">
                                                Never say goodbye till the end comes!
                                            </p>
                                        </div>
                                    </div>
                                    <div class="reply-btn">
                                           <a href="" class="btn-reply text-uppercase">reply</a> 
                                    </div>
                                </div>
                            </div>	                                             				
                        </div>-->
                        <div class="comment-form">
                            <h4>Leave a Reply</h4>
                            <form id="commentForm">
                              {% csrf_token %}
                                <div class="form-group form-inline">
                                  <div class="form-group col-lg-6 col-md-6 name">
                                    <input type="text" class="form-control" id="name" placeholder="Enter Name" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter Name'">
                                  </div>
                                  <div class="form-group col-lg-6 col-md-6 email">
                                    <input type="email" class="form-control" id="email" placeholder="Enter email address" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter email address'">
                                  </div>										
                                </div>
                                <div class="form-group">
                                    <input type="text" class="form-control" id="subject" placeholder="Subject" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Subject'">
                                </div>
                                <div class="form-group">
                                    <textarea class="form-control mb-10" rows="5"id="textmost" name="message" placeholder="Messege" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Messege'" required=""></textarea>
                                </div>
                                <a href="#" class="primary-btn submit_btn" id="submitbutton">Post Comment</a>	
                            </form>
                        </div>
					</div>
					
            <div class="col-lg-4 sidebar-widgets">
						<div class="widget-wrap">
              <div class="single-sidebar-widget search-widget">
                <form class="search-form" action="/searchresult" method="get">
                  
                  <input placeholder="Search Posts" name="search" id="search" type="text" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Search Posts'">
                  <button type="submit"><ion-icon name="search-outline"></ion-icon></button>
                </form>
              </div>
		  
						  <div class="single-sidebar-widget instafeed-widget">
							<h4 class="instafeed-title">Instagram</h4>
							<ul class="instafeed d-flex flex-wrap">
							  <li><img src="{% static 'img/blog/instagram/i1.jpg' %}" alt="image1"></li>
                    <li><img src="{% static 'img/blog/instagram/i2.jpg' %}" alt="image2"></li>
                    <li><img src="{% static 'img/blog/instagram/i3.jpg' %}" alt="image3"></li>
                    <li><img src="{% static 'img/blog/instagram/i4.jpg' %}" alt="image4"></li>
                    <li><img src="{% static 'img/blog/instagram/i5.jpg' %}" alt="image5"></li>
                    <li><img src="{% static 'img/blog/instagram/i6.jpg' %}" alt="image6"></li>
							</ul>
						  </div>
		  
						  <div class="single-sidebar-widget post-category-widget">
							<h4 class="category-title">Catgories</h4>
							<ul class="cat-list mt-20">
                {% for category in categories|slice:":5" %}
                <li>
                  <a href="#" class="d-flex justify-content-between">
                    <p>{{ category.category }}</p>
                    <p>{{category.total}}</p>
                  </a>
                </li>
              {% endfor %}
              </ul>
						  </div>
		  
						  <div class="single-sidebar-widget popular-post-widget">
							<h4 class="popular-title">Popular Posts</h4>
							<div class="popular-post-list">
                {% for t in trending|slice:":5" %}
                <div class="single-post-list">
                  <div class="thumb">
                    <img class="img-fluid" src="{{ t.thumbnail.url }}" alt="popularpost image">
                  </div>
                  <div class="details mt-20">
                    <a href="{% url 'detailview' t.category t.slug %}">
                      <h6>{{t.content|safe|striptags|truncatechars:15}}</h6>
                    </a>
                    <p>{{t.author.username}}| {{t.created}}</p>
                  </div>
                </div>
                {%endfor%}
							</div>
						  </div>
		  
						  <!-- <div class="single-sidebar-widget newsletter-widget">
							<h4 class="newsletter-title">Newsletter</h4>
							<div class="form-group mt-30">
							  <div class="col-autos">
								<input type="text" class="form-control" id="inlineFormInputGroup" placeholder="Enter email" onfocus="this.placeholder = ''"
								  onblur="this.placeholder = 'Enter email'">
							  </div>
							</div>
							<button class="bbtns d-block mt-20 w-100">Subcribe</button>
						  </div> -->
		  
							<div class="single-sidebar-widget share-widget">
							  <h4 class="share-title">Share this post</h4>
							  <div class="social-icons mt-20">
                  <a href="https://www.facebook.com" target="_blank">
                    <span class=""><ion-icon name="logo-facebook"></ion-icon></span>
                  </a>
                  <a href="https://www.twitter.com" target="_blank">
                    <span class=""><ion-icon name="logo-twitter"></ion-icon></span>
                  </a>
                  <a href="https://www.pinterest.com" target="_blank">
                    <span class=""><ion-icon name="logo-pinterest"></ion-icon></span>
                  </a>
                  <a href="https://www.instagram.com" target="_blank">
                    <span class=""><ion-icon name="logo-instagram"></ion-icon></span>
                  </a>
							  </div>
							</div>
						  </div>
						</div>
                </div>
            </div>
        </section>
        <!--================Blog Area =================-->
        {% endblock %}
{% block script %}

<script>
  $(document).ready(function() {
  $('#submitbutton').on('click', function(e) {
    e.preventDefault();

    const name = $('#name').val();
   
    const email = $('#email').val();
    
    const subject = $('#subject').val();
 
    const message = $('#textmost').val();
   
    const csrfToken = $('#commentForm input[name="csrfmiddlewaretoken"]').val();

    // Create a data object with the form values
    var data = {
      name: name,
      email: email,
      subject: subject,
      message: message
    };

    $.ajax({
      type: 'POST',
      url: "/comments/", // Change this URL to your desired endpoint
      data: data,
      beforeSend: function(xhr, settings) {
        xhr.setRequestHeader("X-CSRFToken", csrfToken);
      },
      success: function(response) {
        // Handle success, maybe show a success message
        if (response == 1) {
          // Show success message using SweetAlert
          swal({
            title: "Success",
            text: "Thank you for commenting, your feedback is very helpful",
            icon: "success",
            button: "OK",
          });
          // Clear form inputs after successful submission
          $('#name').val('');
          $('#email').val('');
          $('#subject').val('');
          $('#textmost').val('');
        } 
      },
      error: function(xhr, status, error) {
        // Show error message using SweetAlert
        swal({
          title: "Error",
          text: "There was an error submitting your message. Please try again later.",
          icon: "error",
          button: "OK",
        });
      }
    });
  });
});
</script>

<script>
  
  function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
$(document).ready(function(e) {
  e.preventDefault;
  const postId = $('#analyticsid').text();
  var csrftoken = getCookie('csrftoken');
  
  // Send a request when the page loads
  $.ajax({
    type: 'POST',
    url: "/analytics/", // Replace this with your server endpoint
    data: { postid: postId }, // Send post ID or identifier to the server
    beforeSend: function(xhr, settings) {
            xhr.setRequestHeader('X-CSRFToken', csrftoken);
        },
    success: function(response) {

      console.log("welcome to our website")
    },
    error: function(error) {
      console.error('sorry we are facing some trouble at the moment');
    }
  });
});

</script>
{% endblock %}